<!-- Top Horizontal Navbar -->
<nav
  class="w-full shadow-md px-4 py-3 flex justify-between items-center bg-white fixed top-0 z-50"
>
  <div class="flex items-center">
    <app-pifss-logo variant="horizontal"></app-pifss-logo>
  </div>

  <!-- User Section (uncomment when MSAL is configured) -->
  <!-- @if (authService.isAuthenticated()) {
  <div class="flex items-center gap-4">
    <div class="flex items-center gap-3">
      <div class="w-10 h-10 rounded-full bg-primary flex items-center justify-center shadow-md">
        <span class="text-white font-bold text-sm">
          {{ getUserInitials() }}
        </span>
      </div>
      <div class="hidden sm:block">
        <p class="font-semibold text-gray-900 text-sm">
          {{ authService.getUserDisplayName() }}
        </p>
        <p class="text-xs text-gray-600">
          {{ authService.getUserEmail() }}
        </p>
      </div>
    </div>

    <button
      (click)="logout()"
      class="flex items-center gap-2 px-3 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-all duration-200 group"
      aria-label="تسجيل الخروج"
    >
      <app-svg-icon 
        name="logout" 
        [width]="20" 
        [height]="20"
        customClass="w-5 h-5 group-hover:translate-x-1 transition-transform"
      />
      <span class="font-medium hidden sm:inline">تسجيل الخروج</span>
    </button>
  </div>
  } -->
</nav>

<!-- Sidebar -->
<aside
  class="fixed right-0 top-16 h-[calc(100vh-4rem)] w-64 bg-white shadow-lg z-40 overflow-y-auto border-l"
>
  <div class="p-4 border-b bg-gradient-to-l from-primary/5 to-transparent">
    <h2 class="text-lg font-bold text-gray-800">القائمة الرئيسية</h2>
  </div>

  <nav class="p-4">
    <ul class="space-y-1">
      @for (link of filteredLinks(); track link.path) {
      <li>
        <a
          [routerLink]="link.path"
          routerLinkActive="bg-primary text-white shadow-md hover:bg-primary"
          [routerLinkActiveOptions]="{ exact: false }"
          class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-all duration-200 group relative"
          [class.opacity-50]="link.disabled"
          [class.cursor-not-allowed]="link.disabled"
          [class.pointer-events-none]="link.disabled"
        >
          <div class="flex-shrink-0">
            @if (link.icon) {
            <app-svg-icon
              [name]="link.icon"
              [width]="20"
              [height]="20"
              customClass="w-5 h-5"
            />
            }
          </div>

          <span class="font-medium block flex-1">{{ link.label }}</span>

          @if (link.badge) {
          <span
            class="px-2 py-0.5 text-xs font-semibold rounded-full"
            [ngClass]="{
              'bg-primary/10 text-primary':
                !link.badgeColor || link.badgeColor === 'primary',
              'bg-gray-100 text-gray-600': link.badgeColor === 'secondary',
              'bg-green-100 text-green-600': link.badgeColor === 'success',
              'bg-yellow-100 text-yellow-600': link.badgeColor === 'warning',
              'bg-red-100 text-red-600': link.badgeColor === 'danger'
            }"
          >
            {{ link.badge }}
          </span>
          }

          <div
            class="absolute left-0 top-1/2 -translate-y-1/2 w-1 h-8 bg-primary rounded-r-full transition-all duration-200"
            [class.opacity-100]="isActiveRoute(link.path)"
            [class.opacity-0]="!isActiveRoute(link.path)"
          ></div>
        </a>

        <!-- Nested navigation (if needed in future) -->
        @if (link.children && link.children.length > 0) {
        <ul class="ml-8 mt-1 space-y-1">
          @for (child of link.children; track child.path) {
          <li>
            <a
              [routerLink]="child.path"
              routerLinkActive="text-primary bg-primary/5"
              class="flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-md transition-colors"
            >
              @if (child.icon) {
              <app-svg-icon
                [name]="child.icon"
                [width]="16"
                [height]="16"
                customClass="w-4 h-4"
              />
              }
              <span>{{ child.label }}</span>
            </a>
          </li>
          }
        </ul>
        }
      </li>
      }
    </ul>
  </nav>
</aside>
